<%-
function luaPrint(name, pass)
return name.."**"..pass
end
-%>
<html data-n-head-ssr>
<head>
    <title>keyan</title>
    <meta data-n-head="ssr" charset="utf-8">
    <meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1">
    <meta data-n-head="ssr" data-hid="description" name="description"
          content="My wicked Nuxt.js project">
    <link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico">
    <base href="/">
    <link rel="stylesheet" href="/luci-static/bootstrap/cascade.css">
    <style data-vue-ssr-id="3191d5ad:0 932a8f60:0 15a56e0c:0">.nuxt-progress {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        width: 0;
        opacity: 1;
        transition: width .1s, opacity .4s;
        background-color: #fff;
        z-index: 999999
    }

    html {
        font-family: Source Sans Pro, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, sans-serif;
        font-size: 16px;
        word-spacing: 1px;
        -ms-text-size-adjust: 100%;
        -webkit-text-size-adjust: 100%;
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing: antialiased;
        box-sizing: border-box
    }

    *, :after, :before {
        box-sizing: border-box;
        margin: 0
    }

    .button--green {
        width: 80%;
        display: inline-block;
        border-radius: 4px;
        border: 1px solid #3b8070;
        color: #3b8070;
        text-decoration: none;
        margin: 20px 10px;
        padding: 10px 30px
    }

    .button--green:hover {
        color: #fff;
        background-color: #3b8070
    }


    .divStyle {
        background: #eeeeee;
        display: flex;
        justify-content: center;
    }

    .main > h1[data-v-42a6d4b0] {
        text-align: center;
        letter-spacing: 1px;
        padding: 30px 0;
        color: #fff;
        background: #8db9ff
    }

    .main .btn > a[data-v-42a6d4b0] {
        margin: 0 10px;
        display: block;
        cursor: pointer;
        text-align: center;
        line-height: 300px;
        border-radius: 15px;
        width: 200px;
        height: 300px
    }

    .main .btn > a.left > p[data-v-42a6d4b0] {
        color: #fff;
        letter-spacing: 1px;
        font-size: 24px;
        font-weight: 600
    }

    .main .btn > a.right > p[data-v-42a6d4b0] {
        color: #fff;
        letter-spacing: 1px;
        font-size: 24px;
        font-weight: 600
    }</style>
</head>
<body>
<div class="main" data-v-42a6d4b0>
    <h1 data-v-42a6d4b0>功能页面 <%=luaPrint('win','wakfu')%></h1>
</div>

<div class="divStyle">
    <dl>
        <dd>
            <input id="wifiID1" type="button" onclick="test()" value="Test"
                   class="button--green"/>
            <input id="wifiID2" type="button" onclick="testSocket()" value="TestSocket"
                   class="button--green"/>
            <input id="wifiID3" type="button" onclick="getWifiList()" value="getWifiList"
                   class="button--green"/>
            <input id="wifiID4" type="button" onclick="getJson()" value="getJson"
                   class="button--green"/>
        </dd>
        <dd>
            <input id="system1" type="button" onclick="systemRouter('info')" value="systemInfo"
                   class="button--green"/>

            <input id="system2" type="button"
                   onclick="location.href='<%=build_url('admin/demo/demo1/game')%>'"
                   value="前往首页"
                   class="button--green"/>
        </dd>
    </dl>
    <dl>


    </dl>
</div>

<fieldset class="cbi-section">
    <legend><%:System%></legend>
    <table class="cbi-section-table">
        <tr class="cbi-section-table-row">
            <td><%:Hostname%></td>
            <td><%=luci.sys.hostname() or "?"%></td>
        </tr>
        <tr class="cbi-section-table-row">
            <td><%:Model%></td>
            <td><%=pcdata(model or "?")%></td>
        </tr>
        <tr class="cbi-section-table-row">
            <td><%:Kernel Version%></td>
            <td><%=luci.sys.exec("uname -r")%></td>
        </tr>
        <tr class="cbi-section-table-row">
            <td><%:系统信息%></td>
            <td id="system"><%=system%>/<%=model%></td>
        </tr>
        <tr class="cbi-section-table-row">
            <td><%:全部信息%></td>
            <td id="allInfo"><%=luci.http.formvalue("wan")%>/<%=msg%>/<%=type(rv)%>/<%=status%></td>
        </tr>
    </table>
</fieldset>

<fieldset class="cbi-section" style="display:none">
    <legend><%:DHCPv4 Leases%></legend>

    <table class="cbi-section-table" id="lease_status_table">
        <tr class="cbi-section-table-titles">
            <th class="cbi-section-table-cell"><%:Hostname%></th>
            <th class="cbi-section-table-cell"><%:IPv4-Address%></th>
            <th class="cbi-section-table-cell"><%:MacAddr%></th>
            <th class="cbi-section-table-cell"><%:Leasetime remaining%></th>
        </tr>
        <tr class="cbi-section-table-row">
            <td colspan="4"><em><br/><%:Collecting data...%></em></td>
        </tr>
    </table>
</fieldset>


<fieldset class="cbi-section" style="display:none">
    <legend><%:DHCPv6 Leases%></legend>

    <table class="cbi-section-table" id="lease6_status_table">
        <tr class="cbi-section-table-titles">
            <th class="cbi-section-table-cell"><%:Hostname%></th>
            <th class="cbi-section-table-cell"><%:IPv6-Address%></th>
            <th class="cbi-section-table-cell"><%:DUID%></th>
            <th class="cbi-section-table-cell"><%:Leasetime remaining%></th>
        </tr>
        <tr class="cbi-section-table-row">
            <td colspan="4"><em><br/><%:Collecting data...%></em></td>
        </tr>
    </table>
</fieldset>

<script>window.__NUXT__ = {
    layout: "default",
    data: [{}],
    fetch: [],
    error: null,
    serverRendered: !0,
    routePath: "/"
}</script>

<script type="text/javascript" src="/luci-static/resources/xhr.js"></script>
<script type="text/javascript">
    XHR.get('<%=build_url("admin/demo/demo1/readDemo")%>', {status: 1},
        function (x, info) {
            console.log(info);
            var ss = JSON.stringify(info);
            console.log(ss);

            var ls = document.getElementById('lease_status_table');
            if (ls && info.leases) {
                ls.parentNode.style.display = 'block';
                /* clear all rows */
                while (ls.rows.length > 1)
                    ls.rows[0].parentNode.deleteRow(1);
                for (var i = 0; i < info.leases.length; i++) {
                    var timestr;

                    if (info.leases[i].expires <= 0)
                        timestr = '<em><%:expired%></em>';
                    else
                        timestr = info.leases[i].expires;

                    var tr = ls.rows[0].parentNode.insertRow(-1);
                    tr.className = 'cbi-section-table-row cbi-rowstyle-' + ((i % 2) + 1);

                    tr.insertCell(-1).innerHTML = info.leases[i].hostname ? info.leases[i].hostname : '?';
                    tr.insertCell(-1).innerHTML = info.leases[i].ipaddr;
                    tr.insertCell(-1).innerHTML = info.leases[i].macaddr;
                    tr.insertCell(-1).innerHTML = timestr;
                }
                if (ls.rows.length === 1) {
                    var tr = ls.rows[0].parentNode.insertRow(-1);
                    tr.className = 'cbi-section-table-row';

                    var td = tr.insertCell(-1);
                    td.colSpan = 4;
                    td.innerHTML = '<em><br /><%:There are no active leases.%></em>';
                }
            }

            var ls6 = document.getElementById('lease6_status_table');
            if (ls6 && info.leases6) {
                ls6.parentNode.style.display = 'block';
                /* clear all rows */
                while (ls6.rows.length > 1)
                    ls6.rows[0].parentNode.deleteRow(1);
                for (var i = 0; i < info.leases6.length; i++) {
                    var timestr;

                    if (info.leases6[i].expires <= 0)
                        timestr = '<em><%:expired%></em>';
                    else
                        timestr = info.leases6[i].expires;

                    var tr = ls6.rows[0].parentNode.insertRow(-1);
                    tr.className = 'cbi-section-table-row cbi-rowstyle-' + ((i % 2) + 1);

                    tr.insertCell(-1).innerHTML = info.leases6[i].hostname ? info.leases6[i].hostname : '?';
                    tr.insertCell(-1).innerHTML = info.leases6[i].ip6addr;
                    tr.insertCell(-1).innerHTML = info.leases6[i].duid;
                    tr.insertCell(-1).innerHTML = timestr;
                }
                if (ls6.rows.length === 1) {
                    var tr = ls6.rows[0].parentNode.insertRow(-1);
                    tr.className = 'cbi-section-table-row';

                    var td = tr.insertCell(-1);
                    td.colSpan = 4;
                    td.innerHTML = '<em><br /><%:There are no active leases.%></em>';
                }
            }
        }
    );

    function test() {
        XHR.get('<%=build_url("admin/demo/demo1/test")%>', {status: 10086},
            function (x, info) {
                console.log("test1", info)
            }
        )
    }

    function testSocket() {
        XHR.get('<%=build_url("admin/demo/demo1/testSocket")%>', null,
            function (x, info) {
                console.log("testSocket", {response: x.response, responseTxt: x.responseTxt})
            }
        )
    }

    function getWifiList() {
        XHR.get('<%=build_url("admin/demo/demo1/getWifiList")%>', null,
            function (x, info) {
                console.log("getWifiList", info);
            }
        )

    }

    function getJson() {
        XHR.get('<%=build_url("admin/demo/demo1/getJson")%>', null,
            function (x, info) {
                console.log("getWifiList", info)
            }
        )
    }

    function systemRouter(router, mapValue) {
        XHR.get('<%=build_url("admin/demo/demo1/systemRouter")%>', {
                router: router,
                mapValue: mapValue
            },
            function (x, info) {
                console.log("systemRouter", info)
            }
        )
    }

</script>
</body>
</html>
